!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.ExpressionParser=r():e.ExpressionParser=r()}(this,function(){return function(e){function r(t){if(n[t])return n[t].exports;var o=n[t]={exports:{},id:t,loaded:!1};return e[t].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var n={};return r.m=e,r.c=n,r.p="",r(0)}([function(e,r,n){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0});var u=n(1),a=n(3),c=n(4),s=t(c);s.default.removeBinaryOp("|");var f=function(e,r){function n(e){var o=null;return(0,u.each)(a.ExpressionTypes,function(i){return e.type==i?(o=a.EXP_HANDLER[i](n,t)(e,r),!1):void 0}),o}var t={iterationObj:r};return n((0,s.default)(e))},p=function(){function e(r,n){o(this,e),this.globalScope=r,this.globalFilter=n}return i(e,[{key:"filter",value:function(e){return(0,u.extend)(this.globalFilter,e),this}},{key:"scope",value:function(e){return(0,u.extend)(this.globalScope,e),this}},{key:"parse",value:function(e,r,n){if((0,u.isStr)(e)){r=(0,u.extend)(r,this.globalScope),n=(0,u.extend)(n,this.globalFilter);var t=this._parseStr(e),o=t.target,i=t.filterArr;return this._resolveFilter(i,n)(f(o,r),r)}}},{key:"_resolveFilter",value:function(e,r){return function(n,t){return e.length?((0,u.each)(e,function(e){e=e.split(":");var o=e[0],i=void 0,a=void 0;r&&r[o]&&(i=e.slice(1).map(function(e){return f(e,t)}),a=r[o].apply(t,i),(0,u.isFunc)(a)&&(n=a(n)))}),n):n}}},{key:"_parseStr",value:function(e){return e=e.replace(/\s*/g,"").split("|"),e.length>1?{target:e[0],filterArr:e.slice(1)}:{target:e[0],filterArr:[]}}}]),e}();p.injectExpHandler=function(){},p.ExpressionTypes=a.ExpressionTypes,(0,u.extend)(p,s.default),r.default=p},function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return function(r){return Object.prototype.toString.call(r)=="[object "+e+"]"}},t=r.isFunc=n("Function"),o=(r.isStr=n("String"),r.isArr=n("Array")),i=r.isObj=n("Object"),u=r.each=function(e,r){if(e&&t(r)){var n=Object.keys(e),o=void 0,i=void 0,u=void 0;for(o=0;o<n.length&&(u=n[o],i=e[u],!e.hasOwnProperty(u)||r(i,u)!==!1);o++);}};r.extend=function(e,r){return i(e)||o(e)?(u(r,function(r,n){e[n]=r}),e):e},r.calculator=function(e){return{unary:function(r){return new Function("return "+e+r)},binary:function(r,n){return new Function("return "+r+e+n)}}},r.toArray=function(e){return Array.prototype.slice.call(e)}},function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ExpressionTypes={COMPOUND:"Compound",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",LOGICAL_EXP:"LogicalExpression",CONDITIONAL_EXP:"ConditionalExpression",ARRAY_EXP:"ArrayExpression"},r.ExpressionKeywords={NEW:"new"}},function(e,r,n){"use strict";function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var i;Object.defineProperty(r,"__esModule",{value:!0}),r.EXP_HANDLER=r.ExpressionTypes=void 0;var u=n(2),a=t(u),c=n(1),s=a.ExpressionTypes,f=s.COMPOUND,p=s.IDENTIFIER,l=s.MEMBER_EXP,y=s.LITERAL,d=s.THIS_EXP,v=s.CALL_EXP,E=s.UNARY_EXP,x=s.BINARY_EXP,b=s.LOGICAL_EXP,h=s.CONDITIONAL_EXP,g=s.ARRAY_EXP;r.ExpressionTypes=a.ExpressionTypes,r.EXP_HANDLER=(i={},o(i,f,function(){return function(){}}),o(i,p,function(){return function(e,r){return r[e.name]}}),o(i,l,function(e,r){return function(n){var t=n.object,o=n.property,i=r.iterationObj;switch(n.object.type){case l:r.iterationObj=e(t)[o.name];break;case d:r.iterationObj=i[o.name];break;case p:r.iterationObj=i[t.name][o.name]}return r.iterationObj}}),o(i,y,function(){return function(e){return e.value}}),o(i,v,function(e){return function(r,n){var t=r.callee,o=(0,c.toArray)(r.arguments).map(function(r){return e(r,n)});if(t.type==p){var i=n[t.name];if(i){if((0,c.isFunc)(i))return i.apply(n,o);if((0,c.isObj)(i)&&(0,c.isFunc)(i.func))return i.func.apply(i.context,o)}}}}),o(i,E,function(e){return function(r){return r.argument.type!==E?(0,c.calculator)(r.operator).unary(e(r.argument))():void 0}}),o(i,x,function(e){return function(r){return(0,c.calculator)(r.operator).binary(e(r.left),e(r.right))()}}),o(i,b,function(e){return function(r){return(0,c.calculator)(r.operator).binary(e(r.left),e(r.right))()}}),o(i,h,function(e){return function(r){return e(e(r.test)?r.consequent:r.alternate)}}),o(i,g,function(e){return function(r){var n=[];return(0,c.each)(r.elements,function(r){n.push(e(r))}),n}}),i)},function(e,r,n){!function(n){"use strict";var t="Compound",o="Identifier",i="MemberExpression",u="Literal",a="ThisExpression",c="CallExpression",s="UnaryExpression",f="BinaryExpression",p="LogicalExpression",l="ConditionalExpression",y="ArrayExpression",d=46,v=44,E=39,x=34,b=40,h=41,g=91,O=93,m=63,P=59,_=58,A=function(e,r){var n=new Error(e+" at character "+r);throw n.index=r,n.description=e,n},j=!0,w={"-":j,"!":j,"~":j,"+":j},L={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},I=function(e){var r,n=0;for(var t in e)(r=t.length)>n&&e.hasOwnProperty(t)&&(n=r);return n},T=I(w),X=I(L),R={"true":!0,"false":!1,"null":null},k="this",C=function(e){return L[e]||0},N=function(e,r,n){var t="||"===e||"&&"===e?p:f;return{type:t,operator:e,left:r,right:n}},F=function(e){return e>=48&&57>=e},M=function(e){return 36===e||95===e||e>=65&&90>=e||e>=97&&122>=e},S=function(e){return 36===e||95===e||e>=65&&90>=e||e>=97&&122>=e||e>=48&&57>=e},U=function(e){for(var r,n,f=0,p=e.charAt,j=e.charCodeAt,I=function(r){return p.call(e,r)},U=function(r){return j.call(e,r)},B=e.length,D=function(){for(var e=U(f);32===e||9===e;)e=U(++f)},H=function(){var e,r,n=q();return D(),U(f)!==m?n:(f++,e=H(),e||A("Expected expression",f),D(),U(f)===_?(f++,r=H(),r||A("Expected expression",f),{type:l,test:n,consequent:e,alternate:r}):void A("Expected :",f))},Y=function(){D();for(var r=e.substr(f,X),n=r.length;n>0;){if(L.hasOwnProperty(r))return f+=n,r;r=r.substr(0,--n)}return!1},q=function(){var e,r,n,t,o,i,u,a;if(i=G(),r=Y(),!r)return i;for(o={value:r,prec:C(r)},u=G(),u||A("Expected expression after "+r,f),t=[i,o,u];(r=Y())&&(n=C(r),0!==n);){for(o={value:r,prec:n};t.length>2&&n<=t[t.length-2].prec;)u=t.pop(),r=t.pop().value,i=t.pop(),e=N(r,i,u),t.push(e);e=G(),e||A("Expected expression after "+r,f),t.push(o,e)}for(a=t.length-1,e=t[a];a>1;)e=N(t[a-1].value,t[a-2],e),a-=2;return e},G=function(){var r,n,t;if(D(),r=U(f),F(r)||r===d)return J();if(r===E||r===x)return K();if(M(r)||r===b)return z();if(r===g)return Z();for(n=e.substr(f,T),t=n.length;t>0;){if(w.hasOwnProperty(n))return f+=t,{type:s,operator:n,argument:G(),prefix:!0};n=n.substr(0,--t)}return!1},J=function(){for(var e,r,n="";F(U(f));)n+=I(f++);if(U(f)===d)for(n+=I(f++);F(U(f));)n+=I(f++);if(e=I(f),"e"===e||"E"===e){for(n+=I(f++),e=I(f),("+"===e||"-"===e)&&(n+=I(f++));F(U(f));)n+=I(f++);F(U(f-1))||A("Expected exponent ("+n+I(f)+")",f)}return r=U(f),M(r)?A("Variable names cannot start with a number ("+n+I(f)+")",f):r===d&&A("Unexpected period",f),{type:u,value:parseFloat(n),raw:n}},K=function(){for(var e,r="",n=I(f++),t=!1;B>f;){if(e=I(f++),e===n){t=!0;break}if("\\"===e)switch(e=I(f++)){case"n":r+="\n";break;case"r":r+="\r";break;case"t":r+="	";break;case"b":r+="\b";break;case"f":r+="\f";break;case"v":r+="\x0B"}else r+=e}return t||A('Unclosed quote after "'+r+'"',f),{type:u,value:r,raw:n+r+n}},V=function(){var r,n=U(f),t=f;for(M(n)?f++:A("Unexpected "+I(f),f);B>f&&(n=U(f),S(n));)f++;return r=e.slice(t,f),R.hasOwnProperty(r)?{type:u,value:R[r],raw:r}:r===k?{type:a}:{type:o,name:r}},W=function(e){for(var r,n,o=[];B>f;){if(D(),r=U(f),r===e){f++;break}r===v?f++:(n=H(),n&&n.type!==t||A("Expected comma",f),o.push(n))}return o},z=function(){var e,r;for(e=U(f),r=e===b?Q():V(),D(),e=U(f);e===d||e===g||e===b;)f++,e===d?(D(),r={type:i,computed:!1,object:r,property:V()}):e===g?(r={type:i,computed:!0,object:r,property:H()},D(),e=U(f),e!==O&&A("Unclosed [",f),f++):e===b&&(r={type:c,arguments:W(h),callee:r}),D(),e=U(f);return r},Q=function(){f++;var e=H();return D(),U(f)===h?(f++,e):void A("Unclosed (",f)},Z=function(){return f++,{type:y,elements:W(O)}},$=[];B>f;)r=U(f),r===P||r===v?f++:(n=H())?$.push(n):B>f&&A('Unexpected "'+I(f)+'"',f);return 1===$.length?$[0]:{type:t,body:$}};U.version="0.3.0",U.toString=function(){return"JavaScript Expression Parser (JSEP) v"+U.version},U.addUnaryOp=function(e){return w[e]=j,this},U.addBinaryOp=function(e,r){return X=Math.max(e.length,X),L[e]=r,this},U.removeUnaryOp=function(e){return delete w[e],e.length===T&&(T=I(w)),this},U.removeBinaryOp=function(e){return delete L[e],e.length===X&&(X=I(L)),this};"undefined"!=typeof e&&e.exports?r=e.exports=U:r.parse=U}(this)}])});